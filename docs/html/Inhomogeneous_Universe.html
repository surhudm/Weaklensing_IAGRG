<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The inhomogeneous Universe &mdash; Cosmology IUCAA 2022 0.99 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="The early Universe" href="Early_Universe.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Cosmology IUCAA 2022
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction to Cosmology</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cosmological_principle.html">Cosmological principle</a></li>
<li class="toctree-l1"><a class="reference internal" href="FRW_models.html">Friedmann Robertson Walker models</a></li>
<li class="toctree-l1"><a class="reference internal" href="Early_Universe.html">The early Universe</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The inhomogeneous Universe</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Dark-matter:-the-driver-for-structure-formation">Dark matter: the driver for structure formation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#The-origin-of-fluctuations">The origin of fluctuations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Spherical-collapse-of-a-top-hat-perturbation">Spherical collapse of a top hat perturbation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Formation-and-statistics-of-dark-matter-halos">Formation and statistics of dark matter halos</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Cosmology IUCAA 2022</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>The inhomogeneous Universe</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Inhomogeneous_Universe.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="The-inhomogeneous-Universe">
<h1>The inhomogeneous Universe<a class="headerlink" href="#The-inhomogeneous-Universe" title="Permalink to this headline"></a></h1>
<div class="section" id="Dark-matter:-the-driver-for-structure-formation">
<h2>Dark matter: the driver for structure formation<a class="headerlink" href="#Dark-matter:-the-driver-for-structure-formation" title="Permalink to this headline"></a></h2>
<p>See slides 20, 21 and 22 <a class="reference external" href="https://docs.google.com/presentation/d/13JgChIRF8_mlFjG43Jq4zLCDFdRVWHb4MDyS3pbSjpw/edit#slide=id.g4d5350c37f_0_13">here</a></p>
<p>Dark matter was first proposed by astronomer Fritz Zwicky who observed the velocity dispersion of galaxies in the nearby Coma and Virgo cluster of galaxies. He calculated an estimate of the dynamical mass of the galaxy cluster by using the virial theorem</p>
<p><span class="math">\begin{eqnarray}
\sigma^2 \approx \frac{GM}{R}
\end{eqnarray}</span></p>
<p>He found out that the velocity dispersion implied a dynamical mass for the cluster which was much bigger than the mass contained within the stars of the constituents galaxies. Even after accounting for the gas component (which can only be seen in X-rays and was discovered much later), the mass shortfall meant that something is missing in our understanding of the Universe. Zwicky termed this excess unseen mass, dark matter.</p>
<p>The presence of Dark matter was later confirmed by astronomer Vera Rubin who looked at the rotation velocities of gas in nearby spiral galaxies. If ordinary matter was the only component of matter, then the gas rotation velocities around a galaxy should have shown a Keplerian fall-off with <span class="math notranslate nohighlight">\(v \propto R^{-1/2}\)</span>. Instead she found that the velocity of gas flattens out, implying that the mass distribution should grow as a function of the radius <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>The existence of dark matter is also evident in the CMB temperature fluctuations. Without the presence of dark matter, the fluctuations seen in the temperature power spectrum will have a different characteristic. The height of the peaks in the CMB power spectrum can tell us the ratios of the baryonic matter to that of radiation as well as baryonic matter to matter which does not couple with radiation.</p>
<p>As you will see next the density fluctuations grow as the scale factor in the matter dominated regime. Given that we see density fluctuations in ordinary matter in the CMB of the order <span class="math notranslate nohighlight">\(\delta ~ 10^{-5}\)</span>, these fluctuations would grow at most by a factor 1000 till today. Without the presence of dark matter there is no way they could have formed the large scale structure in the Universe which is highly non-linear with fluctuations of the order <span class="math notranslate nohighlight">\(\delta ~ 100\)</span>. Dark matter could be a
thermal relic which decouled early on in the history of the Universe, and because it decoupled from the thermal bath, its fluctuations were able to grow until the decoupling of protons, electrons and radiation (which happens at recombination).</p>
</div>
<div class="section" id="The-origin-of-fluctuations">
<h2>The origin of fluctuations<a class="headerlink" href="#The-origin-of-fluctuations" title="Permalink to this headline"></a></h2>
<p>Before we study the growth of fluctuations, let us talk about the origin of the density flcutations in the Universe.</p>
<p>At the very early stages the Universe also underwent a phase of an exponential expansion called inflation. Inflation is able to explain why the temperature of the CMB is so uniform. Regions which were in causal contact were expanded such that they now do not remain in causal contact. For the observable Universe to have the same temperature of the CMB throughout, requires about 56 efoldings of inflation. To give an order of magnitude estimate as to how big this is. Consider a physical region
which is a cube of side 3 cm each. This small region will expand to a cube which has side length greater than the distance to the Andromeda galaxy.</p>
<p>Tiny quantum fluctuations during the inflationary era get stretched to astronomical scales, and these fluctuations act as the seeds for the formation of structure in the Universe. The fluctuations are Gaussian in nature. Let us try to understand the statistical properties of these fluctuations.</p>
<p>The overdensity, <span class="math notranslate nohighlight">\(\delta(\vec{x})\)</span> is given by</p>
<p><span class="math">\begin{equation}
\delta(\vec{x}) = \frac{\rho(\vec{x})}{\bar\rho} - 1
\end{equation}</span></p>
<p>Given that the fluctuations are Gaussian one can characterize them fully, by the mean (zero by construction), and the covariance <span class="math notranslate nohighlight">\(\langle\delta(\vec{x})\delta(\vec{x}+\vec{r}) \rangle\)</span>. Invoking translational and rotational invariance, this quantity should only depend upon the modulus of the distance <span class="math notranslate nohighlight">\(|\vec{r}|\)</span>. This quantity is called the two point correlation function, <span class="math notranslate nohighlight">\(\xi(r)\)</span>.</p>
<p>It is often useful to work in Fourier space. The overdensity field in Fourier space is given by</p>
<p><span class="math">\begin{equation}
\delta(\vec{k}) = \int d^3{\vec x} \,\delta(\vec{x}) \,e^{-i\vec{k}.\vec{x}}
\end{equation}</span></p>
<p>The correlation in Fourier space, <span class="math notranslate nohighlight">\(\langle \delta(\vec{k})\delta(\vec{k'}) \rangle\)</span> is then given by</p>
<p><span class="math">\begin{eqnarray}
\langle \delta(\vec{k})\delta(\vec{k'}) \rangle &=& \int d^3 \vec{x'} \int d^{3} \vec{x} \langle \delta(\vec{x}) \delta(\vec{x}') \rangle e^{-i(\vec{k}.\vec{x}+\vec{k}'.\vec{x}')} \\
&=& \int d^3 \vec{x'} e^{-i(\vec{k}+\vec{k'}).\vec{x'}} \left[ \int d^{3} \vec{y} \,\xi(\vec{y}) e^{-i\vec{k}.\vec{y}}\right] \\
&=& (2\pi)^3 P(\vec{k}) \delta_{\rm D} (\vec{k}+\vec{k'})
\end{eqnarray}</span></p>
<p>where we have changed variable to <span class="math notranslate nohighlight">\(\vec{y}=\vec{x}-\vec{x'}\)</span> in the inner integral, the power spectrum <span class="math notranslate nohighlight">\(P(\vec{k})\)</span> is the fourier transform of the correlation function <span class="math notranslate nohighlight">\(\xi(\vec{r})\)</span>. Rotational invariance further demands that the power spectrum should only be a function of the modulus of <span class="math notranslate nohighlight">\(\vec{k}\)</span>. The Power spectrum has dimensions of volume, so the dimensionless quantity <span class="math notranslate nohighlight">\(\Delta(k)\)</span> can be constructed which represents the power per logarithmic interval in
<span class="math notranslate nohighlight">\(k\)</span>,</p>
<p><span class="math">\begin{equation}
\Delta(k) = \frac{k^3}{2\pi^2} P(k)
\end{equation}</span></p>
<p>Similar to the density fluctuations one can also consider potential fluctuations and the power spectrum of potential fluctuations. The potential fluctuations are related to the density fluctuations with the Poisson equation,</p>
<p><span class="math">\begin{eqnarray}
\nabla^2 \delta_{\rm \phi} \propto \delta \\
k^2 \delta_{\rm \phi}(k) \propto \delta(k)
\end{eqnarray}</span></p>
<p>The power in the initial potential fluctuations per logarithmic interval of <span class="math notranslate nohighlight">\(k\)</span> set by inflation is constant due to scale invariance, i.e., $:nbsphinx-math:<cite>Delta</cite><em>{:nbsphinx-math:`phi`} = k^3 P</em>{<span class="math">\phi</span>}(k) = $ constant. This implies that the initial density power spectrum</p>
<p><span class="math">\begin{equation}
P(k) \propto k
\end{equation}</span></p>
<p>The index in the power spectrum has been measured by data, and is quite close to unity although not exactly unity. Since inflation ends at a certain epoch, inflation in fact predicts a slope close to unity, but with slight deviations. This deviation has now been measured at more than 5<span class="math notranslate nohighlight">\(\sigma\)</span> in the data.</p>
<p>These fluctuations are set at the end of inflation. The Universe then enters an era of radiation domination. The density fluctuations set at the end of inflation will grow. There are two regimes to consider, one for fluctuations whose wavelengths are beyond the horizon, and the others where the wavelength is within the horizon. The growth of fluctuations which are larger than the horizon can be understood by understanding that such fluctuations behave as if they are in a Universe of their own,
but with a different curvature. If the background cosmology is flat, then the background Universe obeys</p>
<p><span class="math">\begin{equation}
\left(\frac{\dot{a}}{a}\right)^2 = \frac{8\pi G \rho}{3}
\end{equation}</span></p>
<p>while the Universe with the fluctuation will have</p>
<p><span class="math">\begin{equation}
\left(\frac{\dot{a_1}}{a_1}\right)^2 = \frac{8\pi G \rho(1+\delta)}{3} + \frac{C'}{a_1^2}
\end{equation}</span></p>
<p>As the fluctuations are small, the differences between <span class="math notranslate nohighlight">\(a_1\)</span> and <span class="math notranslate nohighlight">\(a\)</span> are bound to be small. This implies that the two scale factors closely follow each other when the fluctuations are small. Then we can write,</p>
<p><span class="math">\begin{eqnarray}
\frac{8\pi G \rho(1+\delta)}{3} + \frac{C'}{a_1^2} = \frac{8\pi G \rho}{3}
\end{eqnarray}</span></p>
<p>which allows us to show that</p>
<p><span class="math">\begin{eqnarray}
\delta = \frac{-3C'}{a^2\rho}
\end{eqnarray}</span></p>
<p>In the radiation dominated era, <span class="math notranslate nohighlight">\(\rho \propto a^{-4}\)</span>, thus the fluctuations beyond the horizon grow with the scale factor <span class="math notranslate nohighlight">\(a^2\)</span>, while in the matter dominated era where <span class="math notranslate nohighlight">\(\rho \propto a^{-3}\)</span>, the fluctuation grow as the scale factor.</p>
<p>For the growth of fluctuations with wavelengths within the horizon, one needs to consider the timescales for collapse of these perturbations to the time scale of expansion. The time scale for collapse is given by <span class="math notranslate nohighlight">\((G\rho_{\rm m})^{-1/2}\)</span> while the time scale for expansion is given by <span class="math notranslate nohighlight">\((G\rho_{\rm tot})^{-1/2}\)</span>. In the radiation dominated era, the modes within the horizon cannot grow as the expansion time scale is shorter than the collapse time scale. In the matter dominated era the
time scales are comparable and the fluctuations are able to grow at the same rate as you see for scales beyond the horizon. This results in a characteristic power spectrum which has a turnover imprinted at the scale of matter radiation equality. This scale has also been seen in observations now. These inhomogeneities then grow as a function of time in order to form structures that we see today.</p>
<p><img alt="Power spectrum measurements" src="_images/Tegmark_pk.png" /></p>
<figcaption><p>Borrowed from Tegmark et al 2002.</p>
</figcaption><p>Beyond this, the growth rates of all modes are proportional to the scale factor if <span class="math notranslate nohighlight">\(\Omega_{\rm m}=1\)</span>. In reality there are correction factors that need to account for the presence of any vacuum energy density which reduces the variation of the growth factor with the scale factor (but we will not go into the details of this here).</p>
<p>Thus the recipe to understand the large scale structure of the Universe is simple. We set up tiny density perturbations at the epoch of matter radiation equality. Then we evolve them under the rules of gravity. Dark matter only interacts gravitationally, so it is easiest to simulate the behavior of dark matter with collisionless particles in an n-body simulation.</p>
<p>In the animation below, we can see a simulated patch of the Universe about 80 Mpc on each side, which is filled with a large number of particles. These particles are initially kept on a grid, but then slightly perturbed such that the resultant density perturbations follow the power spectrum that we derived above. We can see the result of the evolution of these density perturbations due to gravitational collapse of these density perturbations. We would like to understand this behaviour.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Video</span><span class="p">,</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">YouTubeVideo</span>
<span class="n">width</span><span class="o">=</span><span class="mi">600</span>
<span class="n">height</span><span class="o">=</span><span class="mi">400</span>
<span class="n">YouTubeVideo</span><span class="p">(</span><span class="s2">&quot;eDGtFRj4xXc&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<iframe
    width="600"
    height="400"
    src="https://www.youtube.com/embed/eDGtFRj4xXc"
    frameborder="0"
    allowfullscreen
></iframe></div>
</div>
</div>
<div class="section" id="Spherical-collapse-of-a-top-hat-perturbation">
<h2>Spherical collapse of a top hat perturbation<a class="headerlink" href="#Spherical-collapse-of-a-top-hat-perturbation" title="Permalink to this headline"></a></h2>
<p>The collapse of these perturbations looks quite complicated. Therefore let us first study the collapse of a simple spherical tophat perturbation. Let us assume that we are in a flat matter only cosmological model. Let there be a spherical top hat perturbation with radius <span class="math notranslate nohighlight">\(R_0\)</span> in the density field centered at the origin. The density within this perturbation is given by <span class="math notranslate nohighlight">\(\rho\)</span> such that <span class="math notranslate nohighlight">\(\rho/\rho_{\rm crit} = \rho/\bar\rho = \Omega_{\rm m}&gt;1\)</span>. We would like to understand the
behaviour of this density perturbation with time.</p>
<p>Because of the spherical symmetry, the density perturbation inside <span class="math notranslate nohighlight">\(R_0\)</span> will not be affected by any mass which is outside <span class="math notranslate nohighlight">\(R_0\)</span> and thus will evolve independently as a separate Universe. The radius <span class="math notranslate nohighlight">\(R_0\)</span> of this perturbation will change proportional to the scale factor in this part of the Universe. The scale factor dependence on time is given by the Friedmann equation,</p>
<p><span class="math">\begin{eqnarray}
\frac{1}{a}\frac{da}{dt} = H_0 \left[ \Omega_{\rm m} a^{-3} + (1 - \Omega_{\rm m}) a^{-2} \right]^{1/2}
\end{eqnarray}</span></p>
<p>We have solved this equation before using a code. We saw that the Universe like this reaches a finite maximum scale factor and then the scale factor starts to decrease once again. It turns out that there is actually a parametric solution for this case.</p>
<p>If you change variable such that <span class="math notranslate nohighlight">\(a=A(1-\cos \theta)\)</span> where <span class="math notranslate nohighlight">\(2 A=\Omega_{\rm m}/(\Omega_{\rm m}-1)\)</span>. Then substitute in the left hand side of the equation, we will get that</p>
<p><span class="math">\begin{eqnarray}
\sin^{2} \left(\frac{\theta}{2}\right) \frac{d\theta}{dt} = H_0\frac{\left(\Omega_{\rm m}-1\right)^{3/2}}{\Omega_{\rm m}}
\end{eqnarray}</span></p>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Exercise:</p>
<ul class="simple">
<li><p>Show that the above equation can be indeed obtained after substitution of <span class="math notranslate nohighlight">\(a=A(1-\cos \theta)\)</span> in the Friedmann equation given above.</p></li>
</ul>
</div>
<p>We can get an expression for <span class="math notranslate nohighlight">\(t\)</span> in terms of <span class="math notranslate nohighlight">\(\theta\)</span>, by integrating the above equation, and expressing <span class="math notranslate nohighlight">\(\sin^2 \theta/2\)</span> in terms of <span class="math notranslate nohighlight">\(\cos \theta\)</span>. We obtain <span class="math notranslate nohighlight">\(t = B (\theta - \sin \theta)\)</span> with <span class="math notranslate nohighlight">\(2 B= H_{0}^{-1}\Omega_{\rm m}/(\Omega_{\rm m}-1)^{3/2}\)</span>. Thus the parametric solution for the scale factor is given in terms of <span class="math notranslate nohighlight">\(\theta\)</span> as</p>
<p><span class="math">\begin{eqnarray}
a = A (1-\cos\theta)\\
t = B (\theta - \sin\theta)
\end{eqnarray}</span></p>
<p>The maximum is reached when <span class="math notranslate nohighlight">\(\theta=\pi\)</span>, when <span class="math notranslate nohighlight">\(a=2A\)</span>, <span class="math notranslate nohighlight">\(t=B\pi\)</span>, <span class="math notranslate nohighlight">\(R=2 R_0 A\)</span>, while <span class="math notranslate nohighlight">\(\theta=2\pi\)</span> corresponds to <span class="math notranslate nohighlight">\(a=0\)</span> and <span class="math notranslate nohighlight">\(t=2B\pi\)</span> when the perturbation collapses and reaches a singularity.</p>
<p>One can use perturbation theory in the very initial stages by perturbing around <span class="math notranslate nohighlight">\(\theta \rightarrow 0\)</span>. This allows to work out how the density within the perturbation changes as a function of time. This linear perturbation theory estimate shows that <span class="math notranslate nohighlight">\(\delta \propto a\)</span> in the early part of the evolution (we had worked this out before). We can then ask what would linear theory predict for the overdensity of the perturbation when it collapses in reality. This value of the overdensity
predicted from linear theory is called the critical density threshold for collapse. This value of the critical density threshold for collapse based on linear theory turns out to be equal to 1.686.</p>
<p>Let us consider the leading order expansion of the above formulae in terms of <span class="math notranslate nohighlight">\(\theta\)</span>. Then</p>
<p><span class="math">\begin{eqnarray}
a \approx A \left( \frac{\theta^2}{2}  - \frac{\theta^4}{24} \right) \\
t \approx B \left( \frac{\theta^3}{6} - \frac{\theta^5}{120} \right)
\end{eqnarray}</span></p>
<p>If we consider just the first order then we obtain</p>
<p><span class="math">\begin{eqnarray}
a &\approx& A \frac{\theta^2}{2}\\
t &\approx& B \frac{\theta^3}{6} \\
a &\approx& \frac{A}{2} \left( \frac{6t}{B} \right)^{2/3}
\end{eqnarray}</span></p>
<p>We can iteratively solve for the next order by considering the <span class="math notranslate nohighlight">\(t(\theta)\)</span> expression and noting <span class="math">\begin{eqnarray}
t &\approx& B \frac{\theta^3}{6} \left( 1 - \frac{\theta^2}{20} \right) \\
&\approx& B \frac{\theta^3}{6} \left( 1 - \frac{1}{20}\left(\frac{6t}{B}\right)^{2/3} \right)\\
\theta^3 &\approx& \frac{6t}{B}\left( 1 + \frac{1}{20}\left(\frac{6t}{B}\right)^{2/3} \right)\\
\theta &\approx& \left( \frac{6t}{B} \right)^{1/3} \left( 1 + \frac{1}{60}\left(\frac{6t}{B}\right)^{2/3} \right)
\end{eqnarray}</span></p>
<p>Similarly for <span class="math notranslate nohighlight">\(a(t)\)</span>, we obtain <span class="math">\begin{eqnarray}
a &\approx& \frac{A}{2} \left( \theta^2  - \frac{\theta^4}{12} \right)\\
&\approx& \frac{A}{2} \left(\frac{6t}{B}\right)^{2/3} \left( 1  - \frac{1}{20} \left(\frac{6t}{B}\right)^{2/3}   \right)
\end{eqnarray}</span></p>
<p>The density is given by</p>
<p><span class="math">\begin{eqnarray}
\rho &=& \frac{M}{\frac{4}{3}\pi R(t)^3} \\
&=& \frac{M}{\frac{4}{3}\pi R_0^3 a(t)^3} \\
&=& \frac{M}{\frac{4}{3}\pi R_0^3}\frac{8}{A^3}\left(\frac{B}{6t}\right)^2 \left[ 1 + \frac{3}{20} \left(\frac{6t}{B}\right)^{2/3} \right]\\
&=& \bar \rho  \left[ 1 + \frac{3}{20} \left(\frac{6t}{B}\right)^{2/3} \right]
\end{eqnarray}</span></p>
<p>Therefore the overdensity contrast evolves with time in the initial stages as:</p>
<p><span class="math">\begin{eqnarray}
\delta &=& \left[\frac{3}{20} \left(\frac{6t}{B}\right)^{2/3} \right]
\end{eqnarray}</span></p>
<p>If we just naively continue this extrapolation of how the overdensity grows, we will of course not be able to predict the overdensity at late times (because we are working in the <span class="math notranslate nohighlight">\(\theta\rightarrow 0\)</span> limit). After all we know that the overdensity collapses at <span class="math notranslate nohighlight">\(t=2B\pi\)</span>, when formally the value of the overdensity becomes infinite. But if we naively extrapolate the linear theory prediction, we obtain that the density perturbation collapses when the linear theory prediction gives a
value for the evolved perturbation equal to <span class="math notranslate nohighlight">\(\delta_{\rm sc} \approx 1.686\)</span>.</p>
<p>The perturbation we considered was a spherical top hat perturbation. Perturbations in the Universe are clearly more complicated, since they do not obey spherical symmetry. Thus in reality the collapse does not proceed to a singularity. The various shells of masses start crossing each other and lead to a virialization process for the halo. Let us compute what is the overdensity of the perturbation with respect to the average density of the Universe at the time of collapse.</p>
<p>First note that, <span class="math">\begin{eqnarray}
\frac{\rho(t)}{\rho_{\rm bg}(t)} &=& \left[\frac{a_{\rm bg}}{a(t)}\right]^3\,,
\end{eqnarray}</span> where <span class="math notranslate nohighlight">\(a_{\rm bg}\)</span> is the scale factor of the background Universe. Since we assumed the background model to be a flat Universe with only a matter component, based on the Friedmann equations for the background Universe, we have, <span class="math">\begin{eqnarray}
a_{\rm bg}(t) &=& \left[ \frac{3 H_0 t}{2} \right]^{2/3}\,.
\end{eqnarray}</span> If we substitute the parametric form of the equations for <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(t\)</span> in the Equation for <span class="math notranslate nohighlight">\(\rho(t)/\rho_{\rm bg}\)</span>, we obtain <span class="math">\begin{eqnarray}
\frac{\rho(t)}{\rho_{\rm bg}(t)} &=& \left[\frac{9 H_0^2 B^2 (\theta-\sin \theta)^2}{4A^3(1-\cos\theta)^3}\right]\,.
\end{eqnarray}</span> From the parametric equation and definitions of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span>, we have <span class="math">\begin{eqnarray}
\frac{H_0^2 B^2}{A^3} &=& \frac{2}{\Omega_{\rm m}} \,,
\end{eqnarray}</span> which gives <span class="math">\begin{eqnarray}
\frac{\rho(t)}{\rho_{\rm bg}(t)} &=& \left[\frac{18 (\theta-\sin \theta)^2}{4\Omega_{\rm m}(1-\cos\theta)^3}\right]\,.
\end{eqnarray}</span> The value of <span class="math notranslate nohighlight">\(\Omega_{\rm m}\)</span> is close to unity since the overdensity is small at early times. We can compute the overdensity at turnaround, where the scale factor reaches a maximum value, <span class="math">\begin{eqnarray}
\frac{\rho(t_{\rm ta})}{\rho_{\rm bg}(t_{\rm ta})} &=& \left[\frac{18 \pi^2}{4\times2^3}\right]\, = \frac{9\pi^2}{16} \sim 5.552.
\end{eqnarray}</span> In order to compute the overdensity at virialization, let us first compute the radius of virialization. The total energy of the system is proportional to <span class="math notranslate nohighlight">\(\sim -GM^2/R_{\rm ta}\)</span> as the overdensity is static at turnaround. At virialization we should have the total energy (equal to half of the potential energy) to be <span class="math notranslate nohighlight">\(\sim -GM^2/(2R_{\rm vir})\)</span>. Thus at virialization we should have <span class="math notranslate nohighlight">\(R_{\rm vir}=R_{\rm ta}/2\)</span>.</p>
<p>The virialization time is twice the time at turnaround (<span class="math notranslate nohighlight">\(\theta=\pi\)</span> versus <span class="math notranslate nohighlight">\(2\pi\)</span>, which gives <span class="math notranslate nohighlight">\(t_{\rm vir}=2t_{\rm ta}\)</span>). At this instance, the background density would have fallen compared to that at turnaround by a factor <span class="math notranslate nohighlight">\(a_{\rm vir}^3/a_{\rm ta}^3 = (2^{2/3})^3 = 4\)</span>. On the other hand, since the radius of virialization is half of the radius at turnaround, the density would have grown by factor 8. Thus we obtain that, <span class="math">\begin{eqnarray}
\frac{\rho(t_{\rm vir})}{\rho_{\rm bg}(t_{\rm vir})} &=& \frac{\rho(t_{\rm ta})}{\rho_{\rm bg}(t_{\rm ta})} \times 4 \times 8= 18\pi^2 \sim 178.
\end{eqnarray}</span></p>
<p>We did all these calculations based on the assumption of a background model with only matter and a flat cosmology. These results can be generalized for more complicated models with curvature and dark energy density. In that case, we will get a different growth rate for perturbations in the linear regime (this factor is called the growth rate factor <span class="math notranslate nohighlight">\(D(z)\)</span>), a slightly different collapse threshold and a different value for the virialization overdensity <span class="math notranslate nohighlight">\(\Delta_{\rm vir}\)</span>.</p>
</div>
<div class="section" id="Formation-and-statistics-of-dark-matter-halos">
<h2>Formation and statistics of dark matter halos<a class="headerlink" href="#Formation-and-statistics-of-dark-matter-halos" title="Permalink to this headline"></a></h2>
<p>The fluctuations in the dark matter component at the end of radiation domination have a characteristic power spectrum <span class="math notranslate nohighlight">\(P(k)\)</span>. We have discussed the statistics of these fluctuations before. These flcutuations grow with time leading to the growth of the power spectrum. For scales with overdensities <span class="math notranslate nohighlight">\(\delta &lt;&lt; 1\)</span>, the growth factor can be calculated using linear perturbation theory as we did in the last section. Scales with <span class="math notranslate nohighlight">\(\delta \sim 1\)</span>, their fluctuation amplitudes grow
non-linearly and these scales can collapse in to bound virialized regions as we saw in the simple spherical collapse model.</p>
<p>Now consider a region in a simulation box, evolve its densities with the linear growth factor and compute the average of the overdensity field around it within a sphere of radius <span class="math notranslate nohighlight">\(R\)</span>. We can obtain a distribution of such overdensities if you consider different locations of the simulation box. Given that the initial density field is a Gaussian, this smoothed density field will also be a Gaussian with a certain variance. Let us try to compute this variance.</p>
<p><span class="math">\begin{eqnarray}
\delta_{R}(\vec{x}) = \int d^3 \vec{x}' \delta(\vec{x}') W_{R}(\vec{x}-\vec{x}')
\end{eqnarray}</span> where the window function <span class="math notranslate nohighlight">\(W_{R}(\vec{x}\)</span> can be defined as</p>
<p><span class="math">\begin{equation}
W_R(\vec{r}) = 0 \,\, \forall |\vec{r}|\gt R
\end{equation}</span> <span class="math">\begin{equation}
W_R(\vec{r}) = \frac{3}{4\pi R^3} \,\, \forall |\vec{r}| \leq R
\end{equation}</span></p>
<p>The variance of this field is then given by</p>
<p><span class="math">\begin{eqnarray}
\langle \delta_R(\vec{x})^2 \rangle &=&  \int d^3 \vec{x'} \int d^3 \vec{x''} \langle \delta(\vec{x}')\delta(\vec{x}'')\rangle W_R(\vec{x}-\vec{x}')   W_R(\vec{x}-\vec{x}'') \\
&=& \int d^3 \vec{x'} \int d^3 \vec{x''} \xi(\vec{x}'-\vec{x}'') W_R(\vec{x}-\vec{x}')   W_R(\vec{x}-\vec{x}'')
\end{eqnarray}</span></p>
<p>This double convolution can be easily evaluated in Fourier space and then transformed back to obtain</p>
<p><span class="math">\begin{eqnarray}
\sigma_{R}^2 = \langle \delta_R(\vec{x})^2 \rangle &=&  {\rm FT} \left[ P(k) W_R(k)^2 \right]
\end{eqnarray}</span></p>
<p>As <span class="math notranslate nohighlight">\(R\rightarrow \infty\)</span>, the variance goes to zero, but its behaviour with <span class="math notranslate nohighlight">\(R\)</span> will depend upon the power spectrum. For the power spectrum in the concordance cosmological model, the power spectrum just decreases with <span class="math notranslate nohighlight">\(R\)</span>. Now the initial conditions could be evolved with the linear growth rate, and could be smoothed with a large radius <span class="math notranslate nohighlight">\(R\)</span> and ask if there is any point which has a density above the critical density at a given redshift. The radius can be shrunk until there
are points which have <span class="math notranslate nohighlight">\(\delta_R(\vec{x})\)</span> greater than the critical density threshold. Those locations will correspond to the particles in the initial density field which lead to the formation of a halo of mass <span class="math notranslate nohighlight">\(M\)</span>. Continuing the march downwards would allow us to identify the halos starting from initial conditions.</p>
<p>The fraction of mass bound in halos of mass <span class="math notranslate nohighlight">\(M\)</span> and above can then be calculated as</p>
<p><span class="math">\begin{equation}
F(>M) = \int_{\delta_c}^{\infty} P(\delta|\sigma_{\rm R}) d\delta
\end{equation}</span> <span class="math">\begin{equation}
F(>M) = \frac{1}{2}{\rm erfc} \left(\frac{\delta_c}{\sqrt{2}\sigma_{\rm R}}\right)
\end{equation}</span></p>
<p>The number density of halos with mass in the range <span class="math notranslate nohighlight">\([M, M+dM]\)</span> is given by</p>
<p><span class="math">\begin{equation}
\frac{d}{dM} n(>M) = \frac{\bar\rho}{M}\frac{d}{dM}F(>M)
\end{equation}</span> <span class="math">\begin{equation}
\frac{d}{dM} n(>M)
\propto \frac{\bar\rho}{M^2} \exp\left(-\frac{\delta_{\rm c}^2}{2\sigma^2}\right)\frac{\delta_c}{\sigma}\frac{d\ln\sigma}{d\ln M}
\end{equation}</span> This particular way to derive the halo mass function was first presented by Press and Schechter in 1974. The mass function they found showed that only half of the mass in the Universe would be bound in halos. So they had added a fudge factor of 2 to the mass function they obtained with these arguments. The factor of 2 is already missing in the first equation of the above argument. This was pointed out by Bond et al. 1992. The solution for the statistical problem corresponding to
this problem was first presented by Chandrasekhar some time before (he was not solving the mass function problem). It has to do with regions which are underdense than the critical threshold but are part of bigger overdensities (it is called the cloud-in-cloud problem).</p>
<p>The Press Schechter mass function qualitatively reproduces the halo mass function observed in simulations, you see a power law at the low mass end, and an exponential drop off at the massive end. There have been many advances in understanding the halo mass function theoretically with more quantitative success: in particular the use of ellipsoidal collapse rather than spherical collapse to set the critical threshold for collapse (e.g., Sheth, Mo, Tormen 1999, 2001), stochasticity in the critical
threshold (e.g., Corasaniti et al 2011), statistics of peaks (Paranjape et al. 2013). However, these approaches often lead to better functional forms whose free parameters are tuned in order to fit the halo mass function in arbitrary cosmologies.</p>
<p>The mass function appears fairly universal, but there are small deviations and these have been now well characterized with the help of numerical simulations. Fitting functions or interpolation routines that can compute the mass function for a given mass and redshift are available. The following figure from Tinker et al. (2008) shows a comparison between the halo mass function as measured from numerical simulations and the Press Schechter mass function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">Image</span><span class="p">(</span><span class="s2">&quot;images/mass_function.png&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/Inhomogeneous_Universe_6_0.png" class="no-scaled-link" src="_images/Inhomogeneous_Universe_6_0.png" style="width: 600px;" />
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Early_Universe.html" class="btn btn-neutral float-left" title="The early Universe" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Surhud More.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>